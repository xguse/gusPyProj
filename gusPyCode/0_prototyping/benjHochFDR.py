def benjHoch(pVals,FDR=0.05):
    """
    pVals  = 2D list(hypothesis,p-value) hyopthesis exp = geneName
    FDR    = threshold above which FDR is unacceptable
    usrTot = total number of hypotheses if more than in pVals.
    
    Returns, for all acceptable p-values: hypothesis,origPval,adjustedPval
    """
    # Sort pVals from lowest to highest
    pVals.sort(key=lambda x: x[1])
    pVals.reverse()
    
    n = len(pVals)
    
    lastPval = pVals[0][1]
    for i in range(len(pVals)):
        p    = pVals[i][1]
        adj  = (float(n)/(n-i))
        adjP = p*adj
        miN  = min(adjP,lastPval)
        pVals[i].append(miN)
        lastPval = pVals[i][2]
    
    pVals.reverse()
    return pVals




ps = [['H01',0.11472102930908400000],
      ['H02',0.01171813094387790000],
      ['H03',0.04224309673636020000],
      ['H04',0.00095485311968826900],
      ['H05',0.00044476139241723700],
      ['H06',0.01714605698123840000],
      ['H07',0.03301585628631000000],
      ['H08',0.00010560647049853200],
      ['H09',0.05936738763804130000],
      ['H10',0.09008770525978380000],
      ['H11',0.26439620663360500000],
      ['H12',0.00570988915443850000],
      ['H13',0.09874622034032010000],
      ['H14',0.10796791649248100000],
      ['H15',0.09764916597865330000],
      ['H16',0.80941597183252400000],
      ['H17',0.17943423225392400000],
      ['H18',0.14673699052593200000],
      ['H19',0.06857325136415960000],
      ['H20',0.94616954182576900000],
      ['H21',0.61668022916571200000],
      ['H22',0.98040047662029900000],
      ['H23',0.31267829537999400000],
      ['H24',0.04672473125043700000],
      ['H25',0.89456945763862500000],
      ['H26',0.00137297078498505000],
      ['H27',0.45549018312055600000],
      ['H28',0.63376553337389300000],
      ['H29',0.93919216083293800000],
      ['H30',0.17969873276261300000],
      ['H31',0.06671269389523740000],
      ['H32',0.52378879019888900000],
      ['H33',0.09512201528646370000],
      ['H34',0.78718046267139600000],
      ['H35',0.56462313820509200000],
      ['H36',0.00288596697049005000],
      ['H37',0.02627986555212090000],
      ['H38',0.00206440762381543000],
      ['H39',0.09935440767001180000],
      ['H40',0.19816649844661500000],
      ['H41',0.22098313443918600000],
      ['H42',0.10902751849802400000],
      ['H43',0.96855523882802700000],
      ['H44',0.00074450579752643400],
      ['H45',0.75891146728055300000],
      ['H46',0.03689279063906480000],
      ['H47',0.00000657187928204422],
      ['H48',0.84144926992132700000],
      ['H49',0.00566326392627456000],
      ['H50',0.90896231228331500000],
      ['H51',0.00007291688192959810],
      ['H52',0.13261734077759300000],
      ['H53',0.71829596327866800000]]



rVals = benjHoch(ps,)
None